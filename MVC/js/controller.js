const state = {
  "grids": [
    {
      "location": "top-left",
      "cells": [
        {
          "initial": true,
          "value": "7",
          "solution": "7"
        },
        {
          "initial": false,
          "value": "",
          "solution": "8"
        },
        {
          "initial": false,
          "value": "",
          "solution": "5"
        },
        {
          "initial": false,
          "value": "",
          "solution": "4"
        },
        {
          "initial": false,
          "value": "",
          "solution": "6"
        },
        {
          "initial": false,
          "value": "",
          "solution": "1"
        },
        {
          "initial": false,
          "value": "",
          "solution": "9"
        },
        {
          "initial": true,
          "value": "2",
          "solution": "2"
        },
        {
          "initial": true,
          "value": "3",
          "solution": "3"
        }
      ]
    },
    {
      "location": "top-center",
      "cells": [
        {
          "initial": true,
          "value": "2",
          "solution": "2"
        },
        {
          "initial": false,
          "value": "",
          "solution": "4"
        },
        {
          "initial": true,
          "value": "1",
          "solution": "1"
        },
        {
          "initial": false,
          "value": "",
          "solution": "3"
        },
        {
          "initial": false,
          "value": "",
          "solution": "8"
        },
        {
          "initial": false,
          "value": "",
          "solution": "9"
        },
        {
          "initial": true,
          "value": "6",
          "solution": "6"
        },
        {
          "initial": true,
          "value": "7",
          "solution": "7"
        },
        {
          "initial": false,
          "value": "",
          "solution": "5"
        }
      ]
    },
    {
      "location": "top-right",
      "cells": [
        {
          "initial": false,
          "value": "",
          "solution": "3"
        },
        {
          "initial": true,
          "value": "6",
          "solution": "6"
        },
        {
          "initial": false,
          "value": "",
          "solution": "9"
        },
        {
          "initial": true,
          "value": "7",
          "solution": "7"
        },
        {
          "initial": true,
          "value": "5",
          "solution": "5"
        },
        {
          "initial": true,
          "value": "2",
          "solution": "2"
        },
        {
          "initial": true,
          "value": "8",
          "solution": "8"
        },
        {
          "initial": false,
          "value": "",
          "solution": "4"
        },
        {
          "initial": false,
          "value": "",
          "solution": "1"
        }
      ]
    },
    {
      "location": "middle-left",
      "cells": [
        {
          "initial": true,
          "value": "2",
          "solution": "2"
        },
        {
          "initial": false,
          "value": "",
          "solution": "1"
        },
        {
          "initial": true,
          "value": "4",
          "solution": "4"
        },
        {
          "initial": false,
          "value": "",
          "solution": "3"
        },
        {
          "initial": true,
          "value": "5",
          "solution": "5"
        },
        {
          "initial": false,
          "value": "",
          "solution": "7"
        },
        {
          "initial": false,
          "value": "",
          "solution": "6"
        },
        {
          "initial": true,
          "value": "9",
          "solution": "9"
        },
        {
          "initial": false,
          "value": "",
          "solution": "8"
        }
      ]
    },
    {
      "location": "middle-center",
      "cells": [
        {
          "initial": false,
          "value": "",
          "solution": "8"
        },
        {
          "initial": true,
          "value": "9",
          "solution": "9"
        },
        {
          "initial": true,
          "value": "3",
          "solution": "3"
        },
        {
          "initial": true,
          "value": "1",
          "solution": "1"
        },
        {
          "initial": true,
          "value": "6",
          "solution": "6"
        },
        {
          "initial": true,
          "value": "4",
          "solution": "4"
        },
        {
          "initial": true,
          "value": "5",
          "solution": "5"
        },
        {
          "initial": true,
          "value": "2",
          "solution": "2"
        },
        {
          "initial": false,
          "value": "",
          "solution": "7"
        }
      ]
    },
    {
      "location": "middle-right",
      "cells": [
        {
          "initial": false,
          "value": "",
          "solution": "5"
        },
        {
          "initial": true,
          "value": "7",
          "solution": "7"
        },
        {
          "initial": false,
          "value": "",
          "solution": "6"
        },
        {
          "initial": false,
          "value": "",
          "solution": "9"
        },
        {
          "initial": true,
          "value": "2",
          "solution": "2"
        },
        {
          "initial": false,
          "value": "",
          "solution": "8"
        },
        {
          "initial": true,
          "value": "4",
          "solution": "4"
        },
        {
          "initial": false,
          "value": "",
          "solution": "1"
        },
        {
          "initial": true,
          "value": "3",
          "solution": "3"
        }
      ]
    },
    {
      "location": "bottom-left",
      "cells": [
        {
          "initial": false,
          "value": "",
          "solution": "8"
        },
        {
          "initial": false,
          "value": "",
          "solution": "3"
        },
        {
          "initial": true,
          "value": "6",
          "solution": "6"
        },
        {
          "initial": true,
          "value": "5",
          "solution": "5"
        },
        {
          "initial": true,
          "value": "7",
          "solution": "7"
        },
        {
          "initial": true,
          "value": "2",
          "solution": "2"
        },
        {
          "initial": false,
          "value": "",
          "solution": "1"
        },
        {
          "initial": true,
          "value": "4",
          "solution": "4"
        },
        {
          "initial": false,
          "value": "",
          "solution": "9"
        }
      ]
    },
    {
      "location": "bottom-center",
      "cells": [
        {
          "initial": false,
          "value": "",
          "solution": "4"
        },
        {
          "initial": true,
          "value": "5",
          "solution": "5"
        },
        {
          "initial": true,
          "value": "2",
          "solution": "2"
        },
        {
          "initial": false,
          "value": "",
          "solution": "9"
        },
        {
          "initial": false,
          "value": "",
          "solution": "1"
        },
        {
          "initial": false,
          "value": "",
          "solution": "8"
        },
        {
          "initial": true,
          "value": "7",
          "solution": "7"
        },
        {
          "initial": false,
          "value": "",
          "solution": "3"
        },
        {
          "initial": true,
          "value": "6",
          "solution": "6"
        }
      ]
    },
    {
      "location": "bottom-right",
      "cells": [
        {
          "initial": true,
          "value": "1",
          "solution": "1"
        },
        {
          "initial": true,
          "value": "9",
          "solution": "9"
        },
        {
          "initial": false,
          "value": "7",
          "solution": "7"
        },
        {
          "initial": false,
          "value": "6",
          "solution": "6"
        },
        {
          "initial": false,
          "value": "3",
          "solution": "3"
        },
        {
          "initial": false,
          "value": "4",
          "solution": "4"
        },
        {
          "initial": false,
          "value": "2",
          "solution": "2"
        },
        {
          "initial": false,
          "value": "8",
          "solution": "8"
        },
        {
          "initial": true,
          "value": "5",
          "solution": "5"
        }
      ]
    }
  ]
};

function fillCell(cell, id) {
  const cellInfo = state.grids[Math.floor(id / 9)].cells[id % 9];
  cellInfo.initial ? cell.classList.add('initial') : '';
  cell.innerText = cellInfo.value;
}

function cellClick(cell, id) {
  const activeCell = document.querySelector('td.active');
  if ( activeCell !== null ) {
    activeCell.classList.remove('active');
    activeCell.removeChild(activeCell.querySelector('form.cell-form'));
  }

  if ( cell.classList.contains('initial') ) return;

  cell.classList.add('active');
  cell.append(input());
  getUserInput(cell);
}

function input () {
  const input = document.createElement('form');
  input.classList.add('cell-form');
  const field = document.createElement('input');
  field.type = 'tel';
  field.size = 1;
  field.classList.add('cell-input');
  input.append(field);
  return input;
}

function getUserInput (cell) {
  const form = cell.querySelector('.cell-form');
  form.children[0].focus()
  form.addEventListener('keyup', ({target}) => {
    cell.innerText = target.value;
    cell.classList.remove('active');
    // if (target.value) {
    // }
  })
  form.addEventListener('onSubmit', (e) => {
    e.preventDefault();
    console.log(e);
  });
}

export {
  fillCell,
  cellClick,
}
